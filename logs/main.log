2025-10-22 16:18:47,585 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-10-22 16:18:47,943 - INFO - Found 100 message IDs to check.
2025-10-22 16:18:48,057 - INFO - Label 'ETL-Processed' not found, creating it...
2025-10-22 16:18:48,094 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:18:48,095 - ERROR - Error creating label 'ETL-Processed': <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/labels?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 110, in get_or_create_label_id
    new_label = service.users().labels().create(userId='me', body=label_body).execute()
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/labels?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:18:48,098 - INFO - Processing 100 messages in 3 batches of 40
2025-10-22 16:18:48,098 - INFO - Processing metadata batch 1/3 (40 messages)
2025-10-22 16:18:48,359 - ERROR - Failed to get metadata for 19a0d1e1f6f3a3e9: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d1e1f6f3a3e9?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-22 16:18:48,359 - WARNING - Rate limit hit for message 19a0d1e1f6f3a3e9. Consider reducing batch size.
2025-10-22 16:18:48,359 - ERROR - Failed to get metadata for 19a0d18377bc56ff: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d18377bc56ff?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-22 16:18:48,359 - WARNING - Rate limit hit for message 19a0d18377bc56ff. Consider reducing batch size.
2025-10-22 16:18:48,360 - ERROR - Failed to get metadata for 19a0cbea486327f9: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cbea486327f9?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-22 16:18:48,360 - WARNING - Rate limit hit for message 19a0cbea486327f9. Consider reducing batch size.
2025-10-22 16:18:48,360 - ERROR - Failed to get metadata for 19a0ca7c5105e4e0: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ca7c5105e4e0?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-22 16:18:48,360 - WARNING - Rate limit hit for message 19a0ca7c5105e4e0. Consider reducing batch size.
2025-10-22 16:18:48,865 - INFO - Processing metadata batch 2/3 (40 messages)
2025-10-22 16:18:49,723 - INFO - Processing metadata batch 3/3 (20 messages)
2025-10-22 16:18:49,910 - INFO - Metadata batch processing complete. Received metadata for 96 messages.
2025-10-22 16:18:49,910 - INFO - Extracted vendor 'deerstag' from email invoices+deerstag@perpay.com
2025-10-22 16:18:49,910 - INFO - Extracted vendor 'entrenue' from email invoices+entrenue@perpay.com
2025-10-22 16:18:49,910 - INFO - Extracted vendor 'afclassics' from email invoices+afclassics@perpay.com
2025-10-22 16:18:49,910 - INFO - Extracted vendor 'acme' from email invoices+acme@perpay.com
2025-10-22 16:18:49,910 - INFO - Extracted vendor 'lumisource' from email invoices+lumisource@perpay.com
2025-10-22 16:18:49,910 - INFO - Extracted vendor 'impex' from email invoices+impex@perpay.com
2025-10-22 16:18:49,911 - INFO - Extracted vendor 'entrenue' from email invoices+entrenue@perpay.com
2025-10-22 16:18:49,911 - INFO - Extracted vendor 'entrenue' from email invoices+entrenue@perpay.com
2025-10-22 16:18:49,911 - INFO - Extracted vendor 'modway' from email invoices+modway@perpay.com
2025-10-22 16:18:49,911 - INFO - Extracted vendor 'berghoff' from email invoices+berghoff@perpay.com
2025-10-22 16:18:49,911 - INFO - Extracted vendor 'lumisource' from email invoices+lumisource@perpay.com
2025-10-22 16:18:49,911 - INFO - Extracted vendor 'lumisource' from email invoices+lumisource@perpay.com
2025-10-22 16:18:49,911 - INFO - Extracted vendor 'lumisource' from email invoices+lumisource@perpay.com
2025-10-22 16:18:49,911 - INFO - Extracted vendor 'lumisource' from email invoices+lumisource@perpay.com
2025-10-22 16:18:49,911 - INFO - Extracted vendor 'lumisource' from email invoices+lumisource@perpay.com
2025-10-22 16:18:49,911 - INFO - Extracted vendor 'afclassics' from email invoices+afclassics@perpay.com
2025-10-22 16:18:49,911 - INFO - Extracted vendor 'modway' from email invoices+modway@perpay.com
2025-10-22 16:18:49,911 - INFO - Extracted vendor 'entrenue' from email invoices+entrenue@perpay.com
2025-10-22 16:18:49,911 - INFO - Extracted vendor 'almo' from email invoices+almo@perpay.com
2025-10-22 16:18:49,911 - INFO - Extracted vendor 'almo' from email invoices+almo@perpay.com
2025-10-22 16:18:49,912 - INFO - Extracted vendor 'almo' from email invoices+almo@perpay.com
2025-10-22 16:18:49,912 - INFO - Extracted vendor 'almo' from email invoices+almo@perpay.com
2025-10-22 16:18:49,912 - INFO - Extracted vendor 'almo' from email invoices+almo@perpay.com
2025-10-22 16:18:49,912 - INFO - Extracted vendor 'almo' from email invoices+almo@perpay.com
2025-10-22 16:18:49,912 - INFO - Extracted vendor 'almo' from email invoices+almo@perpay.com
2025-10-22 16:18:49,912 - INFO - Extracted vendor 'almo' from email invoices+almo@perpay.com
2025-10-22 16:18:49,912 - INFO - Extracted vendor 'almo' from email invoices+almo@perpay.com
2025-10-22 16:18:49,912 - INFO - Extracted vendor 'almo' from email invoices+almo@perpay.com
2025-10-22 16:18:49,912 - INFO - Extracted vendor 'almo' from email invoices+almo@perpay.com
2025-10-22 16:18:49,912 - INFO - Extracted vendor 'almo' from email invoices+almo@perpay.com
2025-10-22 16:18:49,912 - INFO - Extracted vendor 'almo' from email invoices+almo@perpay.com
2025-10-22 16:18:49,912 - INFO - Extracted vendor 'almo' from email invoices+almo@perpay.com
2025-10-22 16:18:49,912 - INFO - Extracted vendor 'almo' from email invoices+almo@perpay.com
2025-10-22 16:18:49,912 - INFO - Extracted vendor 'almo' from email invoices+almo@perpay.com
2025-10-22 16:18:49,912 - INFO - Extracted vendor 'songmics' from email invoices+songmics@perpay.com
2025-10-22 16:18:49,912 - INFO - Extracted vendor 'almo' from email invoices+almo@perpay.com
2025-10-22 16:18:49,912 - INFO - Extracted vendor 'almo' from email invoices+almo@perpay.com
2025-10-22 16:18:49,912 - INFO - Extracted vendor 'almo' from email invoices+almo@perpay.com
2025-10-22 16:18:49,912 - INFO - Extracted vendor 'alpinefurniture' from email invoices+alpinefurniture@perpay.com
2025-10-22 16:18:49,913 - INFO - Extracted vendor 'almo' from email invoices+almo@perpay.com
2025-10-22 16:18:49,913 - INFO - Extracted vendor 'almo' from email invoices+almo@perpay.com
2025-10-22 16:18:49,913 - INFO - Extracted vendor 'premco' from email invoices+premco@perpay.com
2025-10-22 16:18:49,913 - INFO - Extracted vendor 'mas' from email invoices+mas@perpay.com
2025-10-22 16:18:49,913 - INFO - Extracted vendor 'mas' from email invoices+mas@perpay.com
2025-10-22 16:18:49,913 - INFO - Extracted vendor 'mas' from email invoices+mas@perpay.com
2025-10-22 16:18:49,913 - INFO - Extracted vendor 'mas' from email invoices+mas@perpay.com
2025-10-22 16:18:49,913 - INFO - Extracted vendor 'mas' from email invoices+mas@perpay.com
2025-10-22 16:18:49,913 - INFO - Extracted vendor 'mas' from email invoices+mas@perpay.com
2025-10-22 16:18:49,913 - INFO - Extracted vendor 'samsonictrading' from email invoices+samsonictrading@perpay.com
2025-10-22 16:18:49,913 - INFO - Extracted vendor 'rymax' from email invoices+rymax@perpay.com
2025-10-22 16:18:49,913 - INFO - Extracted vendor 'afclassics' from email invoices+afclassics@perpay.com
2025-10-22 16:18:49,913 - INFO - Extracted vendor 'jmi' from email invoices+jmi@perpay.com
2025-10-22 16:18:49,913 - INFO - Extracted vendor 'mas' from email invoices+mas@perpay.com
2025-10-22 16:18:49,913 - INFO - Extracted vendor 'mas' from email invoices+mas@perpay.com
2025-10-22 16:18:49,913 - INFO - Extracted vendor 'mas' from email invoices+mas@perpay.com
2025-10-22 16:18:49,913 - INFO - Extracted vendor 'mas' from email invoices+mas@perpay.com
2025-10-22 16:18:49,914 - INFO - Extracted vendor 'mas' from email invoices+mas@perpay.com
2025-10-22 16:18:49,914 - INFO - Extracted vendor 'mas' from email invoices+mas@perpay.com
2025-10-22 16:18:49,914 - INFO - Extracted vendor 'mas' from email invoices+mas@perpay.com
2025-10-22 16:18:49,914 - INFO - Extracted vendor 'mas' from email invoices+mas@perpay.com
2025-10-22 16:18:49,914 - INFO - Extracted vendor 'mas' from email invoices+mas@perpay.com
2025-10-22 16:18:49,914 - INFO - Extracted vendor 'mas' from email invoices+mas@perpay.com
2025-10-22 16:18:49,914 - INFO - Extracted vendor 'crosley' from email invoices+crosley@perpay.com
2025-10-22 16:18:49,914 - INFO - Extracted vendor 'melissaanddoug' from email invoices+melissaanddoug@perpay.com
2025-10-22 16:18:49,914 - INFO - Extracted vendor 'modway' from email invoices+modway@perpay.com
2025-10-22 16:18:49,914 - INFO - Extracted vendor 'modway' from email invoices+modway@perpay.com
2025-10-22 16:18:49,914 - INFO - Extracted vendor 'jmi' from email invoices+jmi@perpay.com
2025-10-22 16:18:49,914 - INFO - Extracted vendor 'mas' from email invoices+mas@perpay.com
2025-10-22 16:18:49,914 - INFO - Extracted vendor 'mas' from email invoices+mas@perpay.com
2025-10-22 16:18:49,914 - INFO - Extracted vendor 'mas' from email invoices+mas@perpay.com
2025-10-22 16:18:49,914 - INFO - Extracted vendor 'mas' from email invoices+mas@perpay.com
2025-10-22 16:18:49,914 - INFO - Extracted vendor 'mas' from email invoices+mas@perpay.com
2025-10-22 16:18:49,914 - INFO - Extracted vendor 'mas' from email invoices+mas@perpay.com
2025-10-22 16:18:49,914 - INFO - Extracted vendor 'mas' from email invoices+mas@perpay.com
2025-10-22 16:18:49,914 - INFO - Extracted vendor 'mas' from email invoices+mas@perpay.com
2025-10-22 16:18:49,915 - INFO - Extracted vendor 'mas' from email invoices+mas@perpay.com
2025-10-22 16:18:49,915 - INFO - Extracted vendor 'mas' from email invoices+mas@perpay.com
2025-10-22 16:18:49,915 - INFO - Extracted vendor 'fulfillmentservice' from email invoices+fulfillmentservice@perpay.com
2025-10-22 16:18:49,915 - INFO - Extracted vendor 'kleerwest' from email invoices+kleerwest@perpay.com
2025-10-22 16:18:49,915 - INFO - Extracted vendor 'kleerwest' from email invoices+kleerwest@perpay.com
2025-10-22 16:18:49,915 - INFO - Extracted vendor 'kleerwest' from email invoices+kleerwest@perpay.com
2025-10-22 16:18:49,915 - INFO - Extracted vendor 'links' from email invoices+links@perpay.com
2025-10-22 16:18:49,915 - INFO - Extracted vendor 'jla' from email invoices+jla@perpay.com
2025-10-22 16:18:49,915 - INFO - Extracted vendor 'orourke' from email invoices+orourke@perpay.com
2025-10-22 16:18:49,915 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-22 16:18:49,915 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-22 16:18:49,915 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-22 16:18:49,915 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-22 16:18:49,915 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-22 16:18:49,915 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-22 16:18:49,915 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-22 16:18:49,915 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-22 16:18:49,915 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-22 16:18:49,915 - INFO - Created metadata_lookup with 93 emails (excluding ETL-Processed)
2025-10-22 16:18:49,915 - INFO - Processing 93 messages in 4 batches of 25
2025-10-22 16:18:49,915 - INFO - Processing batch 1/4 (25 messages)
2025-10-22 16:18:52,173 - INFO - Processing batch 2/4 (25 messages)
2025-10-22 16:18:54,418 - INFO - Processing batch 3/4 (25 messages)
2025-10-22 16:18:56,639 - INFO - Processing batch 4/4 (18 messages)
2025-10-22 16:18:56,822 - INFO - Batch processing complete. Received full payloads for 93 messages.
2025-10-22 16:18:56,822 - INFO - Found attachment: deerstag_invoice_2025_10_22.csv (ID: ANGjdJ8J54RmqbHBi33V...)
2025-10-22 16:18:56,822 - INFO - Found attachment: deerstag_invoice_2025_10_22.csv in message 19a0d8afad970d0b
2025-10-22 16:18:56,822 - INFO - Found attachment: 7201094.pdf (ID: ANGjdJ8tvXG3Iw1W4fTV...)
2025-10-22 16:18:56,822 - INFO - Found attachment: 7201094.csv (ID: ANGjdJ9nc3eNM0yxvb9B...)
2025-10-22 16:18:56,822 - INFO - Found attachment: 7201094.pdf in message 19a0d4cbd98a2224
2025-10-22 16:18:56,822 - INFO - Found attachment: 7201094.csv in message 19a0d4cbd98a2224
2025-10-22 16:18:56,823 - INFO - Found attachment: invoice_0207840.csv (ID: ANGjdJ9gJc-nFFY0RH2e...)
2025-10-22 16:18:56,823 - INFO - Found attachment: invoice_0207841.csv (ID: ANGjdJ_lG1IfWhwh5r0E...)
2025-10-22 16:18:56,823 - INFO - Found attachment: invoice_0207842.csv (ID: ANGjdJ-eLYAloTwtu3qv...)
2025-10-22 16:18:56,823 - INFO - Found attachment: invoice_0207843.csv (ID: ANGjdJ8GgWFfh110N6ZK...)
2025-10-22 16:18:56,823 - INFO - Found attachment: invoice_0207844.csv (ID: ANGjdJ_vwuMAxv3i_6o6...)
2025-10-22 16:18:56,823 - INFO - Found attachment: invoice_0207846.csv (ID: ANGjdJ-0Bl5z1jCLX_CY...)
2025-10-22 16:18:56,823 - INFO - Found attachment: invoice_0207840.csv in message 19a0d433a9de470c
2025-10-22 16:18:56,823 - INFO - Found attachment: invoice_0207841.csv in message 19a0d433a9de470c
2025-10-22 16:18:56,823 - INFO - Found attachment: invoice_0207842.csv in message 19a0d433a9de470c
2025-10-22 16:18:56,823 - INFO - Found attachment: invoice_0207843.csv in message 19a0d433a9de470c
2025-10-22 16:18:56,823 - INFO - Found attachment: invoice_0207844.csv in message 19a0d433a9de470c
2025-10-22 16:18:56,823 - INFO - Found attachment: invoice_0207846.csv in message 19a0d433a9de470c
2025-10-22 16:18:56,823 - INFO - Found attachment: #4457940.pdf (ID: ANGjdJ_JRgzHOXfL2hZJ...)
2025-10-22 16:18:56,823 - INFO - Found attachment: #4457940.pdf in message 19a0d3097b7cfd63
2025-10-22 16:18:56,823 - INFO - Found attachment: Impex Invoice File.csv (ID: ANGjdJ92fr0h8Z0rHZjM...)
2025-10-22 16:18:56,823 - INFO - Found attachment: Impex Invoice File.csv in message 19a0d1811b0c6948
2025-10-22 16:18:56,823 - INFO - Found attachment: 7201036.pdf (ID: ANGjdJ-lCHR_RjxPlF-F...)
2025-10-22 16:18:56,823 - INFO - Found attachment: 7201036.csv (ID: ANGjdJ9ldAHkUXlnfBHg...)
2025-10-22 16:18:56,823 - INFO - Found attachment: 7201036.pdf in message 19a0d16767885d26
2025-10-22 16:18:56,823 - INFO - Found attachment: 7201036.csv in message 19a0d16767885d26
2025-10-22 16:18:56,823 - INFO - Found attachment: 7201028.pdf (ID: ANGjdJ_DI2wKJafg9IWJ...)
2025-10-22 16:18:56,823 - INFO - Found attachment: 7201028.csv (ID: ANGjdJ98XzUTg61kRCSo...)
2025-10-22 16:18:56,823 - INFO - Found attachment: 7201028.pdf in message 19a0d15f92125740
2025-10-22 16:18:56,823 - INFO - Found attachment: 7201028.csv in message 19a0d15f92125740
2025-10-22 16:18:56,823 - INFO - Found attachment: BergHOFF PerPay Invoice 2025_10_22.csv (ID: ANGjdJ-r995AyXDRAndO...)
2025-10-22 16:18:56,823 - INFO - Found attachment: BergHOFF PerPay Invoice 2025_10_22.csv in message 19a0d03187eb3134
2025-10-22 16:18:56,824 - INFO - Found attachment: invoice_0207453.csv (ID: ANGjdJ_dLyrgsHLjLtUs...)
2025-10-22 16:18:56,824 - INFO - Found attachment: invoice_0207711.csv (ID: ANGjdJ8stKmw2N_FXV2-...)
2025-10-22 16:18:56,824 - INFO - Found attachment: invoice_0207712.csv (ID: ANGjdJ_voRhk7Ogon5h_...)
2025-10-22 16:18:56,824 - INFO - Found attachment: invoice_0207730.csv (ID: ANGjdJ9kijVQP4XxceIx...)
2025-10-22 16:18:56,824 - INFO - Found attachment: invoice_0207766.csv (ID: ANGjdJ91X8cmbXiZ5DOn...)
2025-10-22 16:18:56,824 - INFO - Found attachment: invoice_0207453.csv in message 19a0cfb38b3c601b
2025-10-22 16:18:56,824 - INFO - Found attachment: invoice_0207711.csv in message 19a0cfb38b3c601b
2025-10-22 16:18:56,824 - INFO - Found attachment: invoice_0207712.csv in message 19a0cfb38b3c601b
2025-10-22 16:18:56,824 - INFO - Found attachment: invoice_0207730.csv in message 19a0cfb38b3c601b
2025-10-22 16:18:56,824 - INFO - Found attachment: invoice_0207766.csv in message 19a0cfb38b3c601b
2025-10-22 16:18:56,824 - WARNING - No parts found for message 19a0cf800a7db0b0
2025-10-22 16:18:56,824 - INFO - Found attachment: 7200967.pdf (ID: ANGjdJ_S2kaA34ZbFBvX...)
2025-10-22 16:18:56,824 - INFO - Found attachment: 7200967.csv (ID: ANGjdJ_9A1d5-uwSJmRL...)
2025-10-22 16:18:56,824 - INFO - Found attachment: 7200967.pdf in message 19a0cdf5c66a49a3
2025-10-22 16:18:56,824 - INFO - Found attachment: 7200967.csv in message 19a0cdf5c66a49a3
2025-10-22 16:18:56,824 - INFO - Found attachment: L4G8570.pdf (ID: ANGjdJ-Fr40bg2RU4BhA...)
2025-10-22 16:18:56,824 - INFO - Found attachment: L4G8570.pdf in message 19a0cb9448d73fca
2025-10-22 16:18:56,824 - INFO - Found attachment: L4G8540.pdf (ID: ANGjdJ-CVC9SXB32Riur...)
2025-10-22 16:18:56,824 - INFO - Found attachment: L4G8540.pdf in message 19a0cb9292cb8f1f
2025-10-22 16:18:56,824 - INFO - Found attachment: L4G1651.pdf (ID: ANGjdJ_CyyW-Xa_iOEbu...)
2025-10-22 16:18:56,824 - INFO - Found attachment: L4G1651.pdf in message 19a0cb7db318e5bf
2025-10-22 16:18:56,824 - INFO - Found attachment: L4F9990.pdf (ID: ANGjdJ-rHXkPHGi3MeRN...)
2025-10-22 16:18:56,824 - INFO - Found attachment: L4F9990.pdf in message 19a0cb6efeaa888b
2025-10-22 16:18:56,824 - INFO - Found attachment: L4F6161.pdf (ID: ANGjdJ_R_eE652_vJ1Pk...)
2025-10-22 16:18:56,824 - INFO - Found attachment: L4F6161.pdf in message 19a0cb6639741559
2025-10-22 16:18:56,824 - INFO - Found attachment: L4F6180.pdf (ID: ANGjdJ9N82jFN8EY7W2x...)
2025-10-22 16:18:56,824 - INFO - Found attachment: L4F6180.pdf in message 19a0cb65fc3eb068
2025-10-22 16:18:56,824 - INFO - Found attachment: L4F2980.pdf (ID: ANGjdJ8oesJQKEMqH8qb...)
2025-10-22 16:18:56,824 - INFO - Found attachment: L4F2980.pdf in message 19a0cb3912511e45
2025-10-22 16:18:56,824 - INFO - Found attachment: L4F3001.pdf (ID: ANGjdJ_nfM58n0Najjja...)
2025-10-22 16:18:56,824 - INFO - Found attachment: L4F3001.pdf in message 19a0cb38f5a8b688
2025-10-22 16:18:56,824 - INFO - Found attachment: L4F2960.pdf (ID: ANGjdJ9tfTPIPrKqL1f2...)
2025-10-22 16:18:56,824 - INFO - Found attachment: L4F2960.pdf in message 19a0cb38eb1e79e5
2025-10-22 16:18:56,825 - INFO - Found attachment: L4E4810.pdf (ID: ANGjdJ-7ni9oAO_t7DIm...)
2025-10-22 16:18:56,825 - INFO - Found attachment: L4E4810.pdf in message 19a0cae281094014
2025-10-22 16:18:56,825 - INFO - Found attachment: L4E3370.pdf (ID: ANGjdJ9o-f5Hei84PrHr...)
2025-10-22 16:18:56,825 - INFO - Found attachment: L4E3370.pdf in message 19a0cad534e60995
2025-10-22 16:18:56,825 - INFO - Found attachment: L4E3380.pdf (ID: ANGjdJ-dCpQ1WR6gtYEP...)
2025-10-22 16:18:56,825 - INFO - Found attachment: L4E3380.pdf in message 19a0cad52444bc6b
2025-10-22 16:18:56,825 - INFO - Found attachment: L4D8520.pdf (ID: ANGjdJ-xL0e4knIs8zZ5...)
2025-10-22 16:18:56,825 - INFO - Found attachment: L4D8520.pdf in message 19a0cac4d333d41c
2025-10-22 16:18:56,825 - INFO - Found attachment: L4D4360.pdf (ID: ANGjdJ_PQLP6K7DDH7FN...)
2025-10-22 16:18:56,825 - INFO - Found attachment: L4D4360.pdf in message 19a0cab61531a2c5
2025-10-22 16:18:56,825 - INFO - Found attachment: L4D1450.pdf (ID: ANGjdJ_M3-FMZm1QzisZ...)
2025-10-22 16:18:56,825 - INFO - Found attachment: L4D1450.pdf in message 19a0ca9eec4bcee2
2025-10-22 16:18:56,825 - INFO - Found attachment: L4C9190.pdf (ID: ANGjdJ8DrVpdPmbwqU1g...)
2025-10-22 16:18:56,825 - INFO - Found attachment: L4C9190.pdf in message 19a0ca8ce825fce3
2025-10-22 16:18:56,825 - INFO - Found attachment: Batch invoices orders shipped on 10.21.2025.csv (ID: ANGjdJ_dldytOslqZ7XG...)
2025-10-22 16:18:56,825 - INFO - Found attachment: Batch invoices orders shipped on 10.21.2025.csv in message 19a0ca676e6ca623
2025-10-22 16:18:56,825 - INFO - Found attachment: L4C2850.pdf (ID: ANGjdJ8tuvuGXx47Iw0m...)
2025-10-22 16:18:56,825 - INFO - Found attachment: L4C2850.pdf in message 19a0ca421c675a42
2025-10-22 16:18:56,825 - INFO - Found attachment: L4B9270.pdf (ID: ANGjdJ_dm3qEik_DR9CS...)
2025-10-22 16:18:56,825 - INFO - Found attachment: L4B9270.pdf in message 19a0ca2f3b905d03
2025-10-22 16:18:56,825 - INFO - Found attachment: L4B9260.pdf (ID: ANGjdJ-s9JfH45fOfmTS...)
2025-10-22 16:18:56,825 - INFO - Found attachment: L4B9260.pdf in message 19a0ca2d7cd49778
2025-10-22 16:18:56,825 - INFO - Found attachment: alpinefurniture_invoice_2025_10_21.csv (ID: ANGjdJ-C3FkePKgiJmYw...)
2025-10-22 16:18:56,825 - INFO - Found attachment: alpinefurniture_invoice_2025_10_21.csv in message 19a0c9d9d9a69479
2025-10-22 16:18:56,825 - INFO - Found attachment: K8N2261.pdf (ID: ANGjdJ_gqBPZk0cBdp09...)
2025-10-22 16:18:56,825 - INFO - Found attachment: K8N2261.pdf in message 19a0c9d61320e55c
2025-10-22 16:18:56,825 - INFO - Found attachment: K4K6421.pdf (ID: ANGjdJ9eybyUGIqihnit...)
2025-10-22 16:18:56,825 - INFO - Found attachment: K4K6421.pdf in message 19a0c9cf19125261
2025-10-22 16:18:56,825 - INFO - Found attachment: Invoice 102225.csv (ID: ANGjdJ-md9LYg8aaallP...)
2025-10-22 16:18:56,825 - INFO - Found attachment: Invoice 102225.csv in message 19a0c9049fd00e81
2025-10-22 16:18:56,825 - INFO - Found attachment: MAS, Inc._I001444243.pdf (ID: ANGjdJ8318f2DVAiRXel...)
2025-10-22 16:18:56,825 - INFO - Found attachment: MAS, Inc._I001444243.pdf in message 19a0c8c0404668b7
2025-10-22 16:18:56,825 - INFO - Found attachment: MAS, Inc._I001444242.pdf (ID: ANGjdJ9P9O5DLYxUuuk6...)
2025-10-22 16:18:56,826 - INFO - Found attachment: MAS, Inc._I001444242.pdf in message 19a0c8b01eda74aa
2025-10-22 16:18:56,826 - INFO - Found attachment: MAS, Inc._I001444241.pdf (ID: ANGjdJ-p75GSVh9jQo49...)
2025-10-22 16:18:56,826 - INFO - Found attachment: MAS, Inc._I001444241.pdf in message 19a0c89f6a1d9460
2025-10-22 16:18:56,826 - INFO - Found attachment: MAS, Inc._I001444215.pdf (ID: ANGjdJ-bg6q3iJvtOIFO...)
2025-10-22 16:18:56,826 - INFO - Found attachment: MAS, Inc._I001444215.pdf in message 19a0c88340c0b4cf
2025-10-22 16:18:56,826 - INFO - Found attachment: MAS, Inc._I001444214.pdf (ID: ANGjdJ8FewoXKMvQYRRZ...)
2025-10-22 16:18:56,826 - INFO - Found attachment: MAS, Inc._I001444214.pdf in message 19a0c877e733cb31
2025-10-22 16:18:56,826 - INFO - Found attachment: MAS, Inc._I001444213.pdf (ID: ANGjdJ8tYDFGo2itXmC9...)
2025-10-22 16:18:56,826 - INFO - Found attachment: MAS, Inc._I001444213.pdf in message 19a0c86e630371c7
2025-10-22 16:18:56,826 - INFO - Found attachment: PERPAY INVOICE 10.22 USA.pdf (ID: ANGjdJ8MMDiQCdmk_wHQ...)
2025-10-22 16:18:56,826 - INFO - Found attachment: PERPAY Vendor CSV Template 10.22.csv (ID: ANGjdJ90GJBY2oyiA1vA...)
2025-10-22 16:18:56,826 - INFO - Found attachment: PERPAY INVOICE 10.22 USA.pdf in message 19a0c825ea052a1a
2025-10-22 16:18:56,826 - INFO - Found attachment: PERPAY Vendor CSV Template 10.22.csv in message 19a0c825ea052a1a
2025-10-22 16:18:56,826 - INFO - Found attachment: PERPAY01 INVOICES 10.22.25.pdf (ID: ANGjdJ8imnhQeF0fxQ0d...)
2025-10-22 16:18:56,826 - INFO - Found attachment: PERPAY01 INVOICES 10.22.25.pdf in message 19a0c7d2de8806e6
2025-10-22 16:18:56,826 - INFO - Found attachment: SO Invoice INV 265608.pdf (ID: ANGjdJ-XeJSHd5kROUNg...)
2025-10-22 16:18:56,826 - INFO - Found attachment: SO Invoice INV 265608.pdf in message 19a0c6637774ce2b
2025-10-22 16:18:56,826 - INFO - Found attachment: MAS, Inc._I001444168.pdf (ID: ANGjdJ8PkE-COY6jcKEp...)
2025-10-22 16:18:56,826 - INFO - Found attachment: MAS, Inc._I001444168.pdf in message 19a0c5ea299d04e3
2025-10-22 16:18:56,826 - INFO - Found attachment: MAS, Inc._I001444140.pdf (ID: ANGjdJ9P286Vh8YpAwie...)
2025-10-22 16:18:56,826 - INFO - Found attachment: MAS, Inc._I001444140.pdf in message 19a0c5a614bcbba2
2025-10-22 16:18:56,826 - INFO - Found attachment: MAS, Inc._I001444139.pdf (ID: ANGjdJ85jWuU6soDbL0y...)
2025-10-22 16:18:56,826 - INFO - Found attachment: MAS, Inc._I001444139.pdf in message 19a0c5a50dc4b2f8
2025-10-22 16:18:56,826 - INFO - Found attachment: MAS, Inc._I001444141.pdf (ID: ANGjdJ8SjZ_NCADtW1Vw...)
2025-10-22 16:18:56,826 - INFO - Found attachment: MAS, Inc._I001444141.pdf in message 19a0c5a4ecd7b5cf
2025-10-22 16:18:56,826 - INFO - Found attachment: MAS, Inc._I001444138.pdf (ID: ANGjdJ832rkjBjB4LBKO...)
2025-10-22 16:18:56,826 - INFO - Found attachment: MAS, Inc._I001444138.pdf in message 19a0c5a4a69901c2
2025-10-22 16:18:56,826 - INFO - Found attachment: MAS, Inc._I001444115.pdf (ID: ANGjdJ9_pjtlYCAm5ZVV...)
2025-10-22 16:18:56,826 - INFO - Found attachment: MAS, Inc._I001444115.pdf in message 19a0c55047429e81
2025-10-22 16:18:56,826 - INFO - Found attachment: MAS, Inc._I001444118.pdf (ID: ANGjdJ_YvSWKol1W3K-G...)
2025-10-22 16:18:56,826 - INFO - Found attachment: MAS, Inc._I001444118.pdf in message 19a0c54f505d7e7b
2025-10-22 16:18:56,826 - INFO - Found attachment: MAS, Inc._I001444116.pdf (ID: ANGjdJ9hYBGF74i6FdPO...)
2025-10-22 16:18:56,826 - INFO - Found attachment: MAS, Inc._I001444116.pdf in message 19a0c54f177ab054
2025-10-22 16:18:56,826 - INFO - Found attachment: MAS, Inc._I001444117.pdf (ID: ANGjdJ-FWE3e9A0YgCta...)
2025-10-22 16:18:56,826 - INFO - Found attachment: MAS, Inc._I001444117.pdf in message 19a0c54e5d1b8da2
2025-10-22 16:18:56,826 - INFO - Found attachment: MAS, Inc._I001444119.pdf (ID: ANGjdJ-_dokFbZ9PUKmK...)
2025-10-22 16:18:56,827 - INFO - Found attachment: MAS, Inc._I001444119.pdf in message 19a0c54e16a037a4
2025-10-22 16:18:56,827 - INFO - Found attachment: PERPAY.pdf (ID: ANGjdJ-S0LCVeKu5qzJz...)
2025-10-22 16:18:56,827 - INFO - Found attachment: PERPAY.pdf in message 19a0c413af9e3b38
2025-10-22 16:18:56,827 - INFO - Found attachment: Invoices 27695134...27697983.pdf (ID: ANGjdJ9-4H6uzJ5kRmOU...)
2025-10-22 16:18:56,827 - INFO - Found attachment: Invoices 27695134...27697983.pdf in message 19a0c3df79615029
2025-10-22 16:18:56,827 - INFO - Found attachment: SO Invoice INV 265597.pdf (ID: ANGjdJ-wCy8VkZkmuI8V...)
2025-10-22 16:18:56,827 - INFO - Found attachment: SO Invoice INV 265597.pdf in message 19a0c2f4935235c1
2025-10-22 16:18:56,827 - INFO - Found attachment: MAS, Inc._I001443810.pdf (ID: ANGjdJ_0qeqfZFx6i5L0...)
2025-10-22 16:18:56,827 - INFO - Found attachment: MAS, Inc._I001443810.pdf in message 19a0c03e464bd504
2025-10-22 16:18:56,827 - INFO - Found attachment: MAS, Inc._I001443813.pdf (ID: ANGjdJ8Y8Gh4SVMH83iB...)
2025-10-22 16:18:56,827 - INFO - Found attachment: MAS, Inc._I001443813.pdf in message 19a0c039e14876c8
2025-10-22 16:18:56,827 - INFO - Found attachment: MAS, Inc._I001443808.pdf (ID: ANGjdJ_we3NSo0NKzzye...)
2025-10-22 16:18:56,827 - INFO - Found attachment: MAS, Inc._I001443808.pdf in message 19a0c0398615a325
2025-10-22 16:18:56,827 - INFO - Found attachment: MAS, Inc._I001443814.pdf (ID: ANGjdJ-4u1S-n4OmUAcx...)
2025-10-22 16:18:56,827 - INFO - Found attachment: MAS, Inc._I001443814.pdf in message 19a0c038a2f30681
2025-10-22 16:18:56,827 - INFO - Found attachment: MAS, Inc._I001443811.pdf (ID: ANGjdJ9TVk9mJrnX34mz...)
2025-10-22 16:18:56,827 - INFO - Found attachment: MAS, Inc._I001443811.pdf in message 19a0c0388798075a
2025-10-22 16:18:56,827 - INFO - Found attachment: MAS, Inc._I001443809.pdf (ID: ANGjdJ-BFUZ4b0UAbm3s...)
2025-10-22 16:18:56,827 - INFO - Found attachment: MAS, Inc._I001443809.pdf in message 19a0c038205981d8
2025-10-22 16:18:56,827 - INFO - Found attachment: MAS, Inc._I001443804.pdf (ID: ANGjdJ_csF1kngQgmhEV...)
2025-10-22 16:18:56,827 - INFO - Found attachment: MAS, Inc._I001443804.pdf in message 19a0c037c1d893db
2025-10-22 16:18:56,827 - INFO - Found attachment: MAS, Inc._I001443805.pdf (ID: ANGjdJ9Ja2xuoOmHU-nO...)
2025-10-22 16:18:56,827 - INFO - Found attachment: MAS, Inc._I001443805.pdf in message 19a0c0378ebdbbed
2025-10-22 16:18:56,827 - INFO - Found attachment: MAS, Inc._I001443807.pdf (ID: ANGjdJ-oxD4uSfgvru_n...)
2025-10-22 16:18:56,827 - INFO - Found attachment: MAS, Inc._I001443807.pdf in message 19a0c036c3c04e00
2025-10-22 16:18:56,827 - INFO - Found attachment: MAS, Inc._I001443806.pdf (ID: ANGjdJ-FUyL7VPDvttwE...)
2025-10-22 16:18:56,827 - INFO - Found attachment: MAS, Inc._I001443806.pdf in message 19a0c036b3767c09
2025-10-22 16:18:56,827 - INFO - Found attachment: Perpay 10-21.pdf (ID: ANGjdJ8eJt-_k7cna6bI...)
2025-10-22 16:18:56,827 - INFO - Found attachment: Perpay 10-21.pdf in message 19a0be7598a3a0e6
2025-10-22 16:18:56,827 - INFO - Found attachment: Invoice_376576.pdf (ID: ANGjdJ9rzTTjQ5ZlCbui...)
2025-10-22 16:18:56,827 - INFO - Found attachment: Invoice_376576.pdf in message 19a0bd2c0b93eec6
2025-10-22 16:18:56,827 - INFO - Found attachment: Invoice_376575.pdf (ID: ANGjdJ__S4sq-C3beBo5...)
2025-10-22 16:18:56,827 - INFO - Found attachment: Invoice_376575.pdf in message 19a0bd2b995a6aca
2025-10-22 16:18:56,827 - INFO - Found attachment: Invoice_376571.pdf (ID: ANGjdJ9KMd24hMvdTCgs...)
2025-10-22 16:18:56,827 - INFO - Found attachment: Invoice_376571.pdf in message 19a0bd2a63a8b27c
2025-10-22 16:18:56,827 - INFO - Found attachment: Perpay Invoicing.csv (ID: ANGjdJ8XdLpzMF0Z0Dkt...)
2025-10-22 16:18:56,828 - INFO - Found attachment: Perpay Invoicing.csv in message 19a0ba2601ba38f5
2025-10-22 16:18:56,828 - INFO - Found attachment: perpay invoice -10212025.csv (ID: ANGjdJ8V0_SLucorQFC6...)
2025-10-22 16:18:56,828 - INFO - Found attachment: perpay invoice -10212025.csv in message 19a0ba121cb90a09
2025-10-22 16:18:56,828 - INFO - Found attachment: OSC-Invoices 2025-10-21 4 invoices 1-of-1.pdf (ID: ANGjdJ-CSpF0G5YRJofh...)
2025-10-22 16:18:56,828 - INFO - Found attachment: OSC-Invoices 2025-10-21 4 invoices 1-of-1.pdf in message 19a0b944b9690503
2025-10-22 16:18:56,828 - INFO - Found attachment: DhSalesInvoice.Report.pdf (ID: ANGjdJ97Xicg-mmSmQHH...)
2025-10-22 16:18:56,828 - INFO - Found attachment: DhSalesInvoice.Report.pdf in message 19a0ad9f1934ded7
2025-10-22 16:18:56,828 - INFO - Found attachment: DhSalesInvoice.Report.pdf (ID: ANGjdJ-Q2YzfW05arYAg...)
2025-10-22 16:18:56,828 - INFO - Found attachment: DhSalesInvoice.Report.pdf in message 19a0ad9ec2835fcd
2025-10-22 16:18:56,828 - INFO - Found attachment: DhSalesInvoice.Report.pdf (ID: ANGjdJ9C6rXB-ETsOKmy...)
2025-10-22 16:18:56,828 - INFO - Found attachment: DhSalesInvoice.Report.pdf in message 19a0ad9e7b865f96
2025-10-22 16:18:56,828 - INFO - Found attachment: DhSalesInvoice.Report.pdf (ID: ANGjdJ9zSp2a_g53hFov...)
2025-10-22 16:18:56,828 - INFO - Found attachment: DhSalesInvoice.Report.pdf in message 19a0ad9e3748a33a
2025-10-22 16:18:56,828 - INFO - Found attachment: DhSalesInvoice.Report.pdf (ID: ANGjdJ8ukSL5rKf13KCu...)
2025-10-22 16:18:56,828 - INFO - Found attachment: DhSalesInvoice.Report.pdf in message 19a0ad9dfa586ad5
2025-10-22 16:18:56,828 - INFO - Found attachment: DhSalesInvoice.Report.pdf (ID: ANGjdJ8fyN45-UWJ4ejA...)
2025-10-22 16:18:56,828 - INFO - Found attachment: DhSalesInvoice.Report.pdf in message 19a0ad9db199cf1d
2025-10-22 16:18:56,828 - INFO - Found attachment: DhSalesInvoice.Report.pdf (ID: ANGjdJ84LV966UsmYROQ...)
2025-10-22 16:18:56,828 - INFO - Found attachment: DhSalesInvoice.Report.pdf in message 19a0ad9d645b7f9a
2025-10-22 16:18:56,828 - INFO - Found attachment: DhSalesInvoice.Report.pdf (ID: ANGjdJ82PWgaCsvwEg2t...)
2025-10-22 16:18:56,828 - INFO - Found attachment: DhSalesInvoice.Report.pdf in message 19a0ad9d2bfa62a0
2025-10-22 16:18:56,828 - INFO - Found attachment: DhSalesInvoice.Report.pdf (ID: ANGjdJ-KWv3CE7_onQSv...)
2025-10-22 16:18:56,828 - INFO - Found attachment: DhSalesInvoice.Report.pdf in message 19a0ad9cd10e4e3f
2025-10-22 16:18:56,828 - INFO - Fetching and uploading 96 attachments with 0.2s delay between requests
2025-10-22 16:18:56,933 - INFO - Successfully processed attachment 1/96: deerstag_invoice_2025_10_22.csv
2025-10-22 16:18:56,973 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:18:56,974 - ERROR - Error adding ETL-Processed label to message 19a0d8afad970d0b: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d8afad970d0b/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d8afad970d0b/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:18:56,974 - ERROR - Failed to upload attachment 1/96: deerstag_invoice_2025_10_22.csv
2025-10-22 16:18:57,290 - INFO - Successfully processed attachment 2/96: 7201094.pdf
2025-10-22 16:18:57,328 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:18:57,328 - ERROR - Error adding ETL-Processed label to message 19a0d4cbd98a2224: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d4cbd98a2224/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d4cbd98a2224/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:18:57,328 - ERROR - Failed to upload attachment 2/96: 7201094.pdf
2025-10-22 16:18:57,731 - INFO - Successfully processed attachment 3/96: 7201094.csv
2025-10-22 16:18:57,765 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:18:57,765 - ERROR - Error adding ETL-Processed label to message 19a0d4cbd98a2224: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d4cbd98a2224/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d4cbd98a2224/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:18:57,766 - ERROR - Failed to upload attachment 3/96: 7201094.csv
2025-10-22 16:18:58,064 - INFO - Successfully processed attachment 4/96: invoice_0207840.csv
2025-10-22 16:18:58,097 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:18:58,097 - ERROR - Error adding ETL-Processed label to message 19a0d433a9de470c: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d433a9de470c/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d433a9de470c/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:18:58,097 - ERROR - Failed to upload attachment 4/96: invoice_0207840.csv
2025-10-22 16:18:58,421 - INFO - Successfully processed attachment 5/96: invoice_0207841.csv
2025-10-22 16:18:58,460 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:18:58,460 - ERROR - Error adding ETL-Processed label to message 19a0d433a9de470c: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d433a9de470c/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d433a9de470c/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:18:58,461 - ERROR - Failed to upload attachment 5/96: invoice_0207841.csv
2025-10-22 16:18:58,784 - INFO - Successfully processed attachment 6/96: invoice_0207842.csv
2025-10-22 16:18:58,818 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:18:58,819 - ERROR - Error adding ETL-Processed label to message 19a0d433a9de470c: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d433a9de470c/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d433a9de470c/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:18:58,819 - ERROR - Failed to upload attachment 6/96: invoice_0207842.csv
2025-10-22 16:18:59,176 - INFO - Successfully processed attachment 7/96: invoice_0207843.csv
2025-10-22 16:18:59,218 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:18:59,218 - ERROR - Error adding ETL-Processed label to message 19a0d433a9de470c: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d433a9de470c/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d433a9de470c/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:18:59,219 - ERROR - Failed to upload attachment 7/96: invoice_0207843.csv
2025-10-22 16:18:59,524 - INFO - Successfully processed attachment 8/96: invoice_0207844.csv
2025-10-22 16:18:59,558 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:18:59,559 - ERROR - Error adding ETL-Processed label to message 19a0d433a9de470c: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d433a9de470c/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d433a9de470c/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:18:59,559 - ERROR - Failed to upload attachment 8/96: invoice_0207844.csv
2025-10-22 16:18:59,859 - INFO - Successfully processed attachment 9/96: invoice_0207846.csv
2025-10-22 16:18:59,894 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:18:59,894 - ERROR - Error adding ETL-Processed label to message 19a0d433a9de470c: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d433a9de470c/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d433a9de470c/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:18:59,895 - ERROR - Failed to upload attachment 9/96: invoice_0207846.csv
2025-10-22 16:19:00,275 - INFO - Successfully processed attachment 10/96: #4457940.pdf
2025-10-22 16:19:00,314 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:00,314 - ERROR - Error adding ETL-Processed label to message 19a0d3097b7cfd63: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d3097b7cfd63/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d3097b7cfd63/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:00,315 - ERROR - Failed to upload attachment 10/96: #4457940.pdf
2025-10-22 16:19:00,652 - INFO - Successfully processed attachment 11/96: Impex Invoice File.csv
2025-10-22 16:19:00,687 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:00,687 - ERROR - Error adding ETL-Processed label to message 19a0d1811b0c6948: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d1811b0c6948/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d1811b0c6948/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:00,687 - ERROR - Failed to upload attachment 11/96: Impex Invoice File.csv
2025-10-22 16:19:01,040 - INFO - Successfully processed attachment 12/96: 7201036.pdf
2025-10-22 16:19:01,083 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:01,083 - ERROR - Error adding ETL-Processed label to message 19a0d16767885d26: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d16767885d26/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d16767885d26/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:01,083 - ERROR - Failed to upload attachment 12/96: 7201036.pdf
2025-10-22 16:19:01,427 - INFO - Successfully processed attachment 13/96: 7201036.csv
2025-10-22 16:19:01,461 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:01,462 - ERROR - Error adding ETL-Processed label to message 19a0d16767885d26: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d16767885d26/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d16767885d26/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:01,462 - ERROR - Failed to upload attachment 13/96: 7201036.csv
2025-10-22 16:19:01,804 - INFO - Successfully processed attachment 14/96: 7201028.pdf
2025-10-22 16:19:01,841 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:01,841 - ERROR - Error adding ETL-Processed label to message 19a0d15f92125740: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d15f92125740/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d15f92125740/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:01,842 - ERROR - Failed to upload attachment 14/96: 7201028.pdf
2025-10-22 16:19:02,149 - INFO - Successfully processed attachment 15/96: 7201028.csv
2025-10-22 16:19:02,180 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:02,180 - ERROR - Error adding ETL-Processed label to message 19a0d15f92125740: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d15f92125740/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d15f92125740/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:02,180 - ERROR - Failed to upload attachment 15/96: 7201028.csv
2025-10-22 16:19:02,474 - INFO - Successfully processed attachment 16/96: BergHOFF PerPay Invoice 2025_10_22.csv
2025-10-22 16:19:02,509 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:02,509 - ERROR - Error adding ETL-Processed label to message 19a0d03187eb3134: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d03187eb3134/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0d03187eb3134/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:02,510 - ERROR - Failed to upload attachment 16/96: BergHOFF PerPay Invoice 2025_10_22.csv
2025-10-22 16:19:02,842 - INFO - Successfully processed attachment 17/96: invoice_0207453.csv
2025-10-22 16:19:02,882 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:02,882 - ERROR - Error adding ETL-Processed label to message 19a0cfb38b3c601b: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cfb38b3c601b/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cfb38b3c601b/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:02,882 - ERROR - Failed to upload attachment 17/96: invoice_0207453.csv
2025-10-22 16:19:03,189 - INFO - Successfully processed attachment 18/96: invoice_0207711.csv
2025-10-22 16:19:03,223 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:03,223 - ERROR - Error adding ETL-Processed label to message 19a0cfb38b3c601b: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cfb38b3c601b/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cfb38b3c601b/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:03,224 - ERROR - Failed to upload attachment 18/96: invoice_0207711.csv
2025-10-22 16:19:03,554 - INFO - Successfully processed attachment 19/96: invoice_0207712.csv
2025-10-22 16:19:03,589 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:03,589 - ERROR - Error adding ETL-Processed label to message 19a0cfb38b3c601b: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cfb38b3c601b/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cfb38b3c601b/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:03,590 - ERROR - Failed to upload attachment 19/96: invoice_0207712.csv
2025-10-22 16:19:03,887 - INFO - Successfully processed attachment 20/96: invoice_0207730.csv
2025-10-22 16:19:03,920 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:03,921 - ERROR - Error adding ETL-Processed label to message 19a0cfb38b3c601b: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cfb38b3c601b/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cfb38b3c601b/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:03,921 - ERROR - Failed to upload attachment 20/96: invoice_0207730.csv
2025-10-22 16:19:04,247 - INFO - Successfully processed attachment 21/96: invoice_0207766.csv
2025-10-22 16:19:04,279 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:04,280 - ERROR - Error adding ETL-Processed label to message 19a0cfb38b3c601b: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cfb38b3c601b/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cfb38b3c601b/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:04,280 - ERROR - Failed to upload attachment 21/96: invoice_0207766.csv
2025-10-22 16:19:04,617 - INFO - Successfully processed attachment 22/96: 7200967.pdf
2025-10-22 16:19:04,651 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:04,651 - ERROR - Error adding ETL-Processed label to message 19a0cdf5c66a49a3: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cdf5c66a49a3/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cdf5c66a49a3/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:04,651 - ERROR - Failed to upload attachment 22/96: 7200967.pdf
2025-10-22 16:19:04,949 - INFO - Successfully processed attachment 23/96: 7200967.csv
2025-10-22 16:19:04,982 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:04,982 - ERROR - Error adding ETL-Processed label to message 19a0cdf5c66a49a3: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cdf5c66a49a3/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cdf5c66a49a3/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:04,982 - ERROR - Failed to upload attachment 23/96: 7200967.csv
2025-10-22 16:19:05,312 - INFO - Successfully processed attachment 24/96: L4G8570.pdf
2025-10-22 16:19:05,347 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:05,347 - ERROR - Error adding ETL-Processed label to message 19a0cb9448d73fca: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cb9448d73fca/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cb9448d73fca/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:05,347 - ERROR - Failed to upload attachment 24/96: L4G8570.pdf
2025-10-22 16:19:05,670 - INFO - Successfully processed attachment 25/96: L4G8540.pdf
2025-10-22 16:19:05,699 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:05,699 - ERROR - Error adding ETL-Processed label to message 19a0cb9292cb8f1f: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cb9292cb8f1f/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cb9292cb8f1f/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:05,699 - ERROR - Failed to upload attachment 25/96: L4G8540.pdf
2025-10-22 16:19:06,021 - INFO - Successfully processed attachment 26/96: L4G1651.pdf
2025-10-22 16:19:06,056 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:06,056 - ERROR - Error adding ETL-Processed label to message 19a0cb7db318e5bf: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cb7db318e5bf/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cb7db318e5bf/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:06,056 - ERROR - Failed to upload attachment 26/96: L4G1651.pdf
2025-10-22 16:19:06,348 - INFO - Successfully processed attachment 27/96: L4F9990.pdf
2025-10-22 16:19:06,379 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:06,380 - ERROR - Error adding ETL-Processed label to message 19a0cb6efeaa888b: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cb6efeaa888b/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cb6efeaa888b/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:06,380 - ERROR - Failed to upload attachment 27/96: L4F9990.pdf
2025-10-22 16:19:06,700 - INFO - Successfully processed attachment 28/96: L4F6161.pdf
2025-10-22 16:19:06,735 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:06,735 - ERROR - Error adding ETL-Processed label to message 19a0cb6639741559: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cb6639741559/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cb6639741559/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:06,735 - ERROR - Failed to upload attachment 28/96: L4F6161.pdf
2025-10-22 16:19:07,061 - INFO - Successfully processed attachment 29/96: L4F6180.pdf
2025-10-22 16:19:07,101 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:07,101 - ERROR - Error adding ETL-Processed label to message 19a0cb65fc3eb068: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cb65fc3eb068/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cb65fc3eb068/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:07,102 - ERROR - Failed to upload attachment 29/96: L4F6180.pdf
2025-10-22 16:19:07,442 - INFO - Successfully processed attachment 30/96: L4F2980.pdf
2025-10-22 16:19:07,477 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:07,477 - ERROR - Error adding ETL-Processed label to message 19a0cb3912511e45: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cb3912511e45/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cb3912511e45/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:07,478 - ERROR - Failed to upload attachment 30/96: L4F2980.pdf
2025-10-22 16:19:07,794 - INFO - Successfully processed attachment 31/96: L4F3001.pdf
2025-10-22 16:19:07,830 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:07,830 - ERROR - Error adding ETL-Processed label to message 19a0cb38f5a8b688: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cb38f5a8b688/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cb38f5a8b688/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:07,830 - ERROR - Failed to upload attachment 31/96: L4F3001.pdf
2025-10-22 16:19:08,147 - INFO - Successfully processed attachment 32/96: L4F2960.pdf
2025-10-22 16:19:08,183 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:08,183 - ERROR - Error adding ETL-Processed label to message 19a0cb38eb1e79e5: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cb38eb1e79e5/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cb38eb1e79e5/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:08,183 - ERROR - Failed to upload attachment 32/96: L4F2960.pdf
2025-10-22 16:19:08,524 - INFO - Successfully processed attachment 33/96: L4E4810.pdf
2025-10-22 16:19:08,556 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:08,556 - ERROR - Error adding ETL-Processed label to message 19a0cae281094014: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cae281094014/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cae281094014/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:08,556 - ERROR - Failed to upload attachment 33/96: L4E4810.pdf
2025-10-22 16:19:08,869 - INFO - Successfully processed attachment 34/96: L4E3370.pdf
2025-10-22 16:19:08,901 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:08,902 - ERROR - Error adding ETL-Processed label to message 19a0cad534e60995: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cad534e60995/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cad534e60995/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:08,902 - ERROR - Failed to upload attachment 34/96: L4E3370.pdf
2025-10-22 16:19:09,217 - INFO - Successfully processed attachment 35/96: L4E3380.pdf
2025-10-22 16:19:09,254 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:09,254 - ERROR - Error adding ETL-Processed label to message 19a0cad52444bc6b: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cad52444bc6b/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cad52444bc6b/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:09,255 - ERROR - Failed to upload attachment 35/96: L4E3380.pdf
2025-10-22 16:19:09,554 - INFO - Successfully processed attachment 36/96: L4D8520.pdf
2025-10-22 16:19:09,591 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:09,591 - ERROR - Error adding ETL-Processed label to message 19a0cac4d333d41c: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cac4d333d41c/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cac4d333d41c/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:09,592 - ERROR - Failed to upload attachment 36/96: L4D8520.pdf
2025-10-22 16:19:09,926 - INFO - Successfully processed attachment 37/96: L4D4360.pdf
2025-10-22 16:19:09,962 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:09,962 - ERROR - Error adding ETL-Processed label to message 19a0cab61531a2c5: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cab61531a2c5/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0cab61531a2c5/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:09,962 - ERROR - Failed to upload attachment 37/96: L4D4360.pdf
2025-10-22 16:19:10,327 - INFO - Successfully processed attachment 38/96: L4D1450.pdf
2025-10-22 16:19:10,360 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:10,360 - ERROR - Error adding ETL-Processed label to message 19a0ca9eec4bcee2: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ca9eec4bcee2/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ca9eec4bcee2/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:10,361 - ERROR - Failed to upload attachment 38/96: L4D1450.pdf
2025-10-22 16:19:10,683 - INFO - Successfully processed attachment 39/96: L4C9190.pdf
2025-10-22 16:19:10,718 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:10,719 - ERROR - Error adding ETL-Processed label to message 19a0ca8ce825fce3: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ca8ce825fce3/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ca8ce825fce3/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:10,719 - ERROR - Failed to upload attachment 39/96: L4C9190.pdf
2025-10-22 16:19:11,042 - INFO - Successfully processed attachment 40/96: Batch invoices orders shipped on 10.21.2025.csv
2025-10-22 16:19:11,078 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:11,078 - ERROR - Error adding ETL-Processed label to message 19a0ca676e6ca623: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ca676e6ca623/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ca676e6ca623/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:11,078 - ERROR - Failed to upload attachment 40/96: Batch invoices orders shipped on 10.21.2025.csv
2025-10-22 16:19:11,407 - INFO - Successfully processed attachment 41/96: L4C2850.pdf
2025-10-22 16:19:11,442 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:11,442 - ERROR - Error adding ETL-Processed label to message 19a0ca421c675a42: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ca421c675a42/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ca421c675a42/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:11,443 - ERROR - Failed to upload attachment 41/96: L4C2850.pdf
2025-10-22 16:19:11,848 - INFO - Successfully processed attachment 42/96: L4B9270.pdf
2025-10-22 16:19:11,882 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:11,882 - ERROR - Error adding ETL-Processed label to message 19a0ca2f3b905d03: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ca2f3b905d03/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ca2f3b905d03/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:11,883 - ERROR - Failed to upload attachment 42/96: L4B9270.pdf
2025-10-22 16:19:12,213 - INFO - Successfully processed attachment 43/96: L4B9260.pdf
2025-10-22 16:19:12,242 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:12,242 - ERROR - Error adding ETL-Processed label to message 19a0ca2d7cd49778: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ca2d7cd49778/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ca2d7cd49778/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:12,243 - ERROR - Failed to upload attachment 43/96: L4B9260.pdf
2025-10-22 16:19:12,543 - INFO - Successfully processed attachment 44/96: alpinefurniture_invoice_2025_10_21.csv
2025-10-22 16:19:12,581 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:12,581 - ERROR - Error adding ETL-Processed label to message 19a0c9d9d9a69479: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c9d9d9a69479/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c9d9d9a69479/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:12,581 - ERROR - Failed to upload attachment 44/96: alpinefurniture_invoice_2025_10_21.csv
2025-10-22 16:19:12,914 - INFO - Successfully processed attachment 45/96: K8N2261.pdf
2025-10-22 16:19:12,950 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:12,950 - ERROR - Error adding ETL-Processed label to message 19a0c9d61320e55c: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c9d61320e55c/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c9d61320e55c/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:12,950 - ERROR - Failed to upload attachment 45/96: K8N2261.pdf
2025-10-22 16:19:13,278 - INFO - Successfully processed attachment 46/96: K4K6421.pdf
2025-10-22 16:19:13,312 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:13,312 - ERROR - Error adding ETL-Processed label to message 19a0c9cf19125261: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c9cf19125261/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c9cf19125261/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:13,313 - ERROR - Failed to upload attachment 46/96: K4K6421.pdf
2025-10-22 16:19:13,634 - INFO - Successfully processed attachment 47/96: Invoice 102225.csv
2025-10-22 16:19:13,668 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:13,669 - ERROR - Error adding ETL-Processed label to message 19a0c9049fd00e81: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c9049fd00e81/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c9049fd00e81/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:13,669 - ERROR - Failed to upload attachment 47/96: Invoice 102225.csv
2025-10-22 16:19:14,091 - INFO - Successfully processed attachment 48/96: MAS, Inc._I001444243.pdf
2025-10-22 16:19:14,129 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:14,129 - ERROR - Error adding ETL-Processed label to message 19a0c8c0404668b7: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c8c0404668b7/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c8c0404668b7/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:14,130 - ERROR - Failed to upload attachment 48/96: MAS, Inc._I001444243.pdf
2025-10-22 16:19:14,476 - INFO - Successfully processed attachment 49/96: MAS, Inc._I001444242.pdf
2025-10-22 16:19:14,510 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:14,510 - ERROR - Error adding ETL-Processed label to message 19a0c8b01eda74aa: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c8b01eda74aa/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c8b01eda74aa/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:14,510 - ERROR - Failed to upload attachment 49/96: MAS, Inc._I001444242.pdf
2025-10-22 16:19:14,831 - INFO - Successfully processed attachment 50/96: MAS, Inc._I001444241.pdf
2025-10-22 16:19:14,865 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:14,865 - ERROR - Error adding ETL-Processed label to message 19a0c89f6a1d9460: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c89f6a1d9460/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c89f6a1d9460/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:14,865 - ERROR - Failed to upload attachment 50/96: MAS, Inc._I001444241.pdf
2025-10-22 16:19:15,198 - INFO - Successfully processed attachment 51/96: MAS, Inc._I001444215.pdf
2025-10-22 16:19:15,235 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:15,235 - ERROR - Error adding ETL-Processed label to message 19a0c88340c0b4cf: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c88340c0b4cf/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c88340c0b4cf/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:15,236 - ERROR - Failed to upload attachment 51/96: MAS, Inc._I001444215.pdf
2025-10-22 16:19:15,583 - INFO - Successfully processed attachment 52/96: MAS, Inc._I001444214.pdf
2025-10-22 16:19:15,617 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:15,617 - ERROR - Error adding ETL-Processed label to message 19a0c877e733cb31: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c877e733cb31/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c877e733cb31/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:15,618 - ERROR - Failed to upload attachment 52/96: MAS, Inc._I001444214.pdf
2025-10-22 16:19:15,951 - INFO - Successfully processed attachment 53/96: MAS, Inc._I001444213.pdf
2025-10-22 16:19:15,988 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:15,988 - ERROR - Error adding ETL-Processed label to message 19a0c86e630371c7: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c86e630371c7/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c86e630371c7/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:15,989 - ERROR - Failed to upload attachment 53/96: MAS, Inc._I001444213.pdf
2025-10-22 16:19:16,392 - INFO - Successfully processed attachment 54/96: PERPAY INVOICE 10.22 USA.pdf
2025-10-22 16:19:16,432 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:16,432 - ERROR - Error adding ETL-Processed label to message 19a0c825ea052a1a: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c825ea052a1a/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c825ea052a1a/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:16,432 - ERROR - Failed to upload attachment 54/96: PERPAY INVOICE 10.22 USA.pdf
2025-10-22 16:19:16,792 - INFO - Successfully processed attachment 55/96: PERPAY Vendor CSV Template 10.22.csv
2025-10-22 16:19:16,831 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:16,831 - ERROR - Error adding ETL-Processed label to message 19a0c825ea052a1a: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c825ea052a1a/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c825ea052a1a/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:16,832 - ERROR - Failed to upload attachment 55/96: PERPAY Vendor CSV Template 10.22.csv
2025-10-22 16:19:17,185 - INFO - Successfully processed attachment 56/96: PERPAY01 INVOICES 10.22.25.pdf
2025-10-22 16:19:17,219 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:17,219 - ERROR - Error adding ETL-Processed label to message 19a0c7d2de8806e6: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c7d2de8806e6/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c7d2de8806e6/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:17,220 - ERROR - Failed to upload attachment 56/96: PERPAY01 INVOICES 10.22.25.pdf
2025-10-22 16:19:17,543 - INFO - Successfully processed attachment 57/96: SO Invoice INV 265608.pdf
2025-10-22 16:19:17,576 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:17,577 - ERROR - Error adding ETL-Processed label to message 19a0c6637774ce2b: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c6637774ce2b/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c6637774ce2b/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:17,577 - ERROR - Failed to upload attachment 57/96: SO Invoice INV 265608.pdf
2025-10-22 16:19:17,908 - INFO - Successfully processed attachment 58/96: MAS, Inc._I001444168.pdf
2025-10-22 16:19:17,946 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:17,946 - ERROR - Error adding ETL-Processed label to message 19a0c5ea299d04e3: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c5ea299d04e3/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c5ea299d04e3/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:17,946 - ERROR - Failed to upload attachment 58/96: MAS, Inc._I001444168.pdf
2025-10-22 16:19:18,297 - INFO - Successfully processed attachment 59/96: MAS, Inc._I001444140.pdf
2025-10-22 16:19:18,333 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:18,333 - ERROR - Error adding ETL-Processed label to message 19a0c5a614bcbba2: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c5a614bcbba2/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c5a614bcbba2/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:18,334 - ERROR - Failed to upload attachment 59/96: MAS, Inc._I001444140.pdf
2025-10-22 16:19:18,650 - INFO - Successfully processed attachment 60/96: MAS, Inc._I001444139.pdf
2025-10-22 16:19:18,681 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:18,681 - ERROR - Error adding ETL-Processed label to message 19a0c5a50dc4b2f8: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c5a50dc4b2f8/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c5a50dc4b2f8/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:18,682 - ERROR - Failed to upload attachment 60/96: MAS, Inc._I001444139.pdf
2025-10-22 16:19:19,009 - INFO - Successfully processed attachment 61/96: MAS, Inc._I001444141.pdf
2025-10-22 16:19:19,044 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:19,044 - ERROR - Error adding ETL-Processed label to message 19a0c5a4ecd7b5cf: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c5a4ecd7b5cf/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c5a4ecd7b5cf/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:19,044 - ERROR - Failed to upload attachment 61/96: MAS, Inc._I001444141.pdf
2025-10-22 16:19:19,400 - INFO - Successfully processed attachment 62/96: MAS, Inc._I001444138.pdf
2025-10-22 16:19:19,428 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:19,429 - ERROR - Error adding ETL-Processed label to message 19a0c5a4a69901c2: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c5a4a69901c2/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c5a4a69901c2/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:19,429 - ERROR - Failed to upload attachment 62/96: MAS, Inc._I001444138.pdf
2025-10-22 16:19:19,792 - INFO - Successfully processed attachment 63/96: MAS, Inc._I001444115.pdf
2025-10-22 16:19:19,824 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:19,824 - ERROR - Error adding ETL-Processed label to message 19a0c55047429e81: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c55047429e81/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c55047429e81/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:19,825 - ERROR - Failed to upload attachment 63/96: MAS, Inc._I001444115.pdf
2025-10-22 16:19:20,170 - INFO - Successfully processed attachment 64/96: MAS, Inc._I001444118.pdf
2025-10-22 16:19:20,209 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:20,210 - ERROR - Error adding ETL-Processed label to message 19a0c54f505d7e7b: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c54f505d7e7b/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c54f505d7e7b/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:20,211 - ERROR - Failed to upload attachment 64/96: MAS, Inc._I001444118.pdf
2025-10-22 16:19:20,544 - INFO - Successfully processed attachment 65/96: MAS, Inc._I001444116.pdf
2025-10-22 16:19:20,582 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:20,583 - ERROR - Error adding ETL-Processed label to message 19a0c54f177ab054: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c54f177ab054/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c54f177ab054/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:20,583 - ERROR - Failed to upload attachment 65/96: MAS, Inc._I001444116.pdf
2025-10-22 16:19:20,917 - INFO - Successfully processed attachment 66/96: MAS, Inc._I001444117.pdf
2025-10-22 16:19:20,954 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:20,954 - ERROR - Error adding ETL-Processed label to message 19a0c54e5d1b8da2: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c54e5d1b8da2/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c54e5d1b8da2/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:20,955 - ERROR - Failed to upload attachment 66/96: MAS, Inc._I001444117.pdf
2025-10-22 16:19:21,297 - INFO - Successfully processed attachment 67/96: MAS, Inc._I001444119.pdf
2025-10-22 16:19:21,332 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:21,332 - ERROR - Error adding ETL-Processed label to message 19a0c54e16a037a4: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c54e16a037a4/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c54e16a037a4/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:21,332 - ERROR - Failed to upload attachment 67/96: MAS, Inc._I001444119.pdf
2025-10-22 16:19:21,643 - INFO - Successfully processed attachment 68/96: PERPAY.pdf
2025-10-22 16:19:21,678 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:21,678 - ERROR - Error adding ETL-Processed label to message 19a0c413af9e3b38: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c413af9e3b38/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c413af9e3b38/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:21,678 - ERROR - Failed to upload attachment 68/96: PERPAY.pdf
2025-10-22 16:19:22,029 - INFO - Successfully processed attachment 69/96: Invoices 27695134...27697983.pdf
2025-10-22 16:19:22,064 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:22,064 - ERROR - Error adding ETL-Processed label to message 19a0c3df79615029: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c3df79615029/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c3df79615029/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:22,065 - ERROR - Failed to upload attachment 69/96: Invoices 27695134...27697983.pdf
2025-10-22 16:19:22,406 - INFO - Successfully processed attachment 70/96: SO Invoice INV 265597.pdf
2025-10-22 16:19:22,441 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:22,442 - ERROR - Error adding ETL-Processed label to message 19a0c2f4935235c1: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c2f4935235c1/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c2f4935235c1/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:22,442 - ERROR - Failed to upload attachment 70/96: SO Invoice INV 265597.pdf
2025-10-22 16:19:22,788 - INFO - Successfully processed attachment 71/96: MAS, Inc._I001443810.pdf
2025-10-22 16:19:22,829 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:22,830 - ERROR - Error adding ETL-Processed label to message 19a0c03e464bd504: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c03e464bd504/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c03e464bd504/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:22,830 - ERROR - Failed to upload attachment 71/96: MAS, Inc._I001443810.pdf
2025-10-22 16:19:23,163 - INFO - Successfully processed attachment 72/96: MAS, Inc._I001443813.pdf
2025-10-22 16:19:23,199 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:23,199 - ERROR - Error adding ETL-Processed label to message 19a0c039e14876c8: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c039e14876c8/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c039e14876c8/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:23,199 - ERROR - Failed to upload attachment 72/96: MAS, Inc._I001443813.pdf
2025-10-22 16:19:23,529 - INFO - Successfully processed attachment 73/96: MAS, Inc._I001443808.pdf
2025-10-22 16:19:23,565 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:23,565 - ERROR - Error adding ETL-Processed label to message 19a0c0398615a325: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c0398615a325/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c0398615a325/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:23,565 - ERROR - Failed to upload attachment 73/96: MAS, Inc._I001443808.pdf
2025-10-22 16:19:23,918 - INFO - Successfully processed attachment 74/96: MAS, Inc._I001443814.pdf
2025-10-22 16:19:23,953 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:23,953 - ERROR - Error adding ETL-Processed label to message 19a0c038a2f30681: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c038a2f30681/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c038a2f30681/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:23,954 - ERROR - Failed to upload attachment 74/96: MAS, Inc._I001443814.pdf
2025-10-22 16:19:24,277 - INFO - Successfully processed attachment 75/96: MAS, Inc._I001443811.pdf
2025-10-22 16:19:24,311 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:24,312 - ERROR - Error adding ETL-Processed label to message 19a0c0388798075a: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c0388798075a/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c0388798075a/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:24,312 - ERROR - Failed to upload attachment 75/96: MAS, Inc._I001443811.pdf
2025-10-22 16:19:24,611 - INFO - Successfully processed attachment 76/96: MAS, Inc._I001443809.pdf
2025-10-22 16:19:24,641 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:24,641 - ERROR - Error adding ETL-Processed label to message 19a0c038205981d8: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c038205981d8/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c038205981d8/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:24,641 - ERROR - Failed to upload attachment 76/96: MAS, Inc._I001443809.pdf
2025-10-22 16:19:24,973 - INFO - Successfully processed attachment 77/96: MAS, Inc._I001443804.pdf
2025-10-22 16:19:25,008 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:25,009 - ERROR - Error adding ETL-Processed label to message 19a0c037c1d893db: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c037c1d893db/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c037c1d893db/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:25,009 - ERROR - Failed to upload attachment 77/96: MAS, Inc._I001443804.pdf
2025-10-22 16:19:25,345 - INFO - Successfully processed attachment 78/96: MAS, Inc._I001443805.pdf
2025-10-22 16:19:25,407 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:25,407 - ERROR - Error adding ETL-Processed label to message 19a0c0378ebdbbed: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c0378ebdbbed/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c0378ebdbbed/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:25,408 - ERROR - Failed to upload attachment 78/96: MAS, Inc._I001443805.pdf
2025-10-22 16:19:25,770 - INFO - Successfully processed attachment 79/96: MAS, Inc._I001443807.pdf
2025-10-22 16:19:25,807 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:25,808 - ERROR - Error adding ETL-Processed label to message 19a0c036c3c04e00: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c036c3c04e00/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c036c3c04e00/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:25,808 - ERROR - Failed to upload attachment 79/96: MAS, Inc._I001443807.pdf
2025-10-22 16:19:26,176 - INFO - Successfully processed attachment 80/96: MAS, Inc._I001443806.pdf
2025-10-22 16:19:26,210 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:26,210 - ERROR - Error adding ETL-Processed label to message 19a0c036b3767c09: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c036b3767c09/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0c036b3767c09/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:26,210 - ERROR - Failed to upload attachment 80/96: MAS, Inc._I001443806.pdf
2025-10-22 16:19:26,595 - INFO - Successfully processed attachment 81/96: Perpay 10-21.pdf
2025-10-22 16:19:26,632 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:26,632 - ERROR - Error adding ETL-Processed label to message 19a0be7598a3a0e6: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0be7598a3a0e6/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0be7598a3a0e6/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:26,632 - ERROR - Failed to upload attachment 81/96: Perpay 10-21.pdf
2025-10-22 16:19:26,988 - INFO - Successfully processed attachment 82/96: Invoice_376576.pdf
2025-10-22 16:19:27,045 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:27,046 - ERROR - Error adding ETL-Processed label to message 19a0bd2c0b93eec6: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0bd2c0b93eec6/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0bd2c0b93eec6/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:27,046 - ERROR - Failed to upload attachment 82/96: Invoice_376576.pdf
2025-10-22 16:19:27,413 - INFO - Successfully processed attachment 83/96: Invoice_376575.pdf
2025-10-22 16:19:27,460 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:27,460 - ERROR - Error adding ETL-Processed label to message 19a0bd2b995a6aca: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0bd2b995a6aca/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0bd2b995a6aca/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:27,461 - ERROR - Failed to upload attachment 83/96: Invoice_376575.pdf
2025-10-22 16:19:27,826 - INFO - Successfully processed attachment 84/96: Invoice_376571.pdf
2025-10-22 16:19:27,882 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:27,882 - ERROR - Error adding ETL-Processed label to message 19a0bd2a63a8b27c: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0bd2a63a8b27c/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0bd2a63a8b27c/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:27,882 - ERROR - Failed to upload attachment 84/96: Invoice_376571.pdf
2025-10-22 16:19:28,215 - INFO - Successfully processed attachment 85/96: Perpay Invoicing.csv
2025-10-22 16:19:28,245 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:28,245 - ERROR - Error adding ETL-Processed label to message 19a0ba2601ba38f5: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ba2601ba38f5/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ba2601ba38f5/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:28,246 - ERROR - Failed to upload attachment 85/96: Perpay Invoicing.csv
2025-10-22 16:19:28,568 - INFO - Successfully processed attachment 86/96: perpay invoice -10212025.csv
2025-10-22 16:19:28,604 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:28,604 - ERROR - Error adding ETL-Processed label to message 19a0ba121cb90a09: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ba121cb90a09/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ba121cb90a09/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:28,604 - ERROR - Failed to upload attachment 86/96: perpay invoice -10212025.csv
2025-10-22 16:19:28,931 - INFO - Successfully processed attachment 87/96: OSC-Invoices 2025-10-21 4 invoices 1-of-1.pdf
2025-10-22 16:19:28,961 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:28,961 - ERROR - Error adding ETL-Processed label to message 19a0b944b9690503: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0b944b9690503/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0b944b9690503/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:28,962 - ERROR - Failed to upload attachment 87/96: OSC-Invoices 2025-10-21 4 invoices 1-of-1.pdf
2025-10-22 16:19:29,267 - INFO - Successfully processed attachment 88/96: DhSalesInvoice.Report.pdf
2025-10-22 16:19:29,311 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:29,311 - ERROR - Error adding ETL-Processed label to message 19a0ad9f1934ded7: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ad9f1934ded7/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ad9f1934ded7/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:29,311 - ERROR - Failed to upload attachment 88/96: DhSalesInvoice.Report.pdf
2025-10-22 16:19:29,613 - INFO - Successfully processed attachment 89/96: DhSalesInvoice.Report.pdf
2025-10-22 16:19:29,642 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:29,643 - ERROR - Error adding ETL-Processed label to message 19a0ad9ec2835fcd: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ad9ec2835fcd/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ad9ec2835fcd/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:29,643 - ERROR - Failed to upload attachment 89/96: DhSalesInvoice.Report.pdf
2025-10-22 16:19:29,985 - INFO - Successfully processed attachment 90/96: DhSalesInvoice.Report.pdf
2025-10-22 16:19:30,018 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:30,018 - ERROR - Error adding ETL-Processed label to message 19a0ad9e7b865f96: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ad9e7b865f96/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ad9e7b865f96/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:30,018 - ERROR - Failed to upload attachment 90/96: DhSalesInvoice.Report.pdf
2025-10-22 16:19:30,384 - INFO - Successfully processed attachment 91/96: DhSalesInvoice.Report.pdf
2025-10-22 16:19:30,432 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:30,432 - ERROR - Error adding ETL-Processed label to message 19a0ad9e3748a33a: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ad9e3748a33a/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ad9e3748a33a/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:30,432 - ERROR - Failed to upload attachment 91/96: DhSalesInvoice.Report.pdf
2025-10-22 16:19:30,790 - INFO - Successfully processed attachment 92/96: DhSalesInvoice.Report.pdf
2025-10-22 16:19:30,835 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:30,836 - ERROR - Error adding ETL-Processed label to message 19a0ad9dfa586ad5: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ad9dfa586ad5/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ad9dfa586ad5/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:30,836 - ERROR - Failed to upload attachment 92/96: DhSalesInvoice.Report.pdf
2025-10-22 16:19:31,179 - INFO - Successfully processed attachment 93/96: DhSalesInvoice.Report.pdf
2025-10-22 16:19:31,232 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:31,232 - ERROR - Error adding ETL-Processed label to message 19a0ad9db199cf1d: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ad9db199cf1d/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ad9db199cf1d/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:31,233 - ERROR - Failed to upload attachment 93/96: DhSalesInvoice.Report.pdf
2025-10-22 16:19:31,579 - INFO - Successfully processed attachment 94/96: DhSalesInvoice.Report.pdf
2025-10-22 16:19:31,621 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:31,621 - ERROR - Error adding ETL-Processed label to message 19a0ad9d645b7f9a: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ad9d645b7f9a/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ad9d645b7f9a/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:31,621 - ERROR - Failed to upload attachment 94/96: DhSalesInvoice.Report.pdf
2025-10-22 16:19:31,952 - INFO - Successfully processed attachment 95/96: DhSalesInvoice.Report.pdf
2025-10-22 16:19:31,980 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:31,980 - ERROR - Error adding ETL-Processed label to message 19a0ad9d2bfa62a0: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ad9d2bfa62a0/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ad9d2bfa62a0/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:31,981 - ERROR - Failed to upload attachment 95/96: DhSalesInvoice.Report.pdf
2025-10-22 16:19:32,307 - INFO - Successfully processed attachment 96/96: DhSalesInvoice.Report.pdf
2025-10-22 16:19:32,336 - WARNING - Encountered 403 Forbidden with reason "insufficientPermissions"
2025-10-22 16:19:32,337 - ERROR - Error adding ETL-Processed label to message 19a0ad9cd10e4e3f: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ad9cd10e4e3f/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
Traceback (most recent call last):
  File "/Users/lillianjiang/gmailConnector/helper_functions.py", line 129, in add_etl_processed_label
    service.users().messages().modify(
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/Users/lillianjiang/gmailConnector/.venv/lib/python3.9/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a0ad9cd10e4e3f/modify?alt=json returned "Request had insufficient authentication scopes.". Details: "[{'message': 'Insufficient Permission', 'domain': 'global', 'reason': 'insufficientPermissions'}]">
2025-10-22 16:19:32,337 - ERROR - Failed to upload attachment 96/96: DhSalesInvoice.Report.pdf
2025-10-22 16:19:32,337 - INFO - Successfully processed 96 out of 96 attachments
2025-10-23 10:51:37,119 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-10-23 11:04:55,730 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-10-23 11:05:07,108 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-10-23 11:18:27,303 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-10-23 11:18:27,689 - INFO - Found 0 message IDs to check.
2025-10-23 11:18:36,513 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-10-23 11:18:36,831 - INFO - Found 0 message IDs to check.
2025-10-23 11:19:40,269 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-10-23 11:19:40,573 - INFO - Found 0 message IDs to check.
2025-10-23 11:20:35,964 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-10-23 11:20:36,745 - INFO - Found 100 message IDs to check.
2025-10-23 11:23:35,386 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-10-23 11:23:35,725 - INFO - Found 0 message IDs to check.
2025-10-23 11:23:58,333 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-10-23 11:23:58,635 - INFO - Found 2 message IDs to check.
2025-10-23 11:26:02,870 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-10-23 11:26:03,234 - INFO - Found 0 message IDs to check.
2025-10-23 11:26:18,916 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-10-23 11:26:19,230 - INFO - Found 0 message IDs to check.
2025-10-23 11:26:24,879 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-10-23 11:26:25,200 - INFO - Found 0 message IDs to check.
2025-10-23 11:27:08,106 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-10-23 11:27:08,430 - INFO - Found 26 message IDs to check.
2025-10-23 11:27:18,894 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-10-23 11:27:19,196 - INFO - Found 100 message IDs to check.
2025-10-23 11:29:14,869 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-10-23 11:29:15,237 - INFO - Found 18 message IDs to check.
2025-10-23 11:30:09,059 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-10-23 11:30:09,350 - INFO - Found 3 message IDs to check.
2025-10-23 11:30:25,316 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-10-23 11:30:25,629 - INFO - Found 2 message IDs to check.
2025-10-23 11:31:22,737 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-10-23 11:31:23,486 - INFO - Found 100 message IDs to check.
2025-10-23 11:32:00,070 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-10-23 11:32:00,484 - INFO - Found 100 message IDs to check.
2025-10-23 11:32:00,484 - INFO - Processing 100 messages in 3 batches of 40
2025-10-23 11:32:00,484 - INFO - Processing metadata batch 1/3 (40 messages)
2025-10-23 11:32:01,152 - ERROR - Failed to get metadata for 19a10033d5e721cb: <HttpError 503 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a10033d5e721cb?format=metadata&alt=json returned "The service is currently unavailable.". Details: "[{'message': 'The service is currently unavailable.', 'domain': 'global', 'reason': 'backendError'}]">
2025-10-23 11:32:01,658 - INFO - Processing metadata batch 2/3 (40 messages)
2025-10-23 11:32:01,906 - ERROR - Failed to get metadata for 19a1003056c0668d: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a1003056c0668d?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-23 11:32:01,906 - WARNING - Rate limit hit for message 19a1003056c0668d. Consider reducing batch size.
2025-10-23 11:32:01,907 - ERROR - Failed to get metadata for 19a1002f96db4352: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a1002f96db4352?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-23 11:32:01,907 - WARNING - Rate limit hit for message 19a1002f96db4352. Consider reducing batch size.
2025-10-23 11:32:01,907 - ERROR - Failed to get metadata for 19a1002909cb5b75: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a1002909cb5b75?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-23 11:32:01,907 - WARNING - Rate limit hit for message 19a1002909cb5b75. Consider reducing batch size.
2025-10-23 11:32:01,907 - ERROR - Failed to get metadata for 19a100286c3720fd: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a100286c3720fd?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-23 11:32:01,907 - WARNING - Rate limit hit for message 19a100286c3720fd. Consider reducing batch size.
2025-10-23 11:32:02,414 - INFO - Processing metadata batch 3/3 (20 messages)
2025-10-23 11:32:02,611 - INFO - Metadata batch processing complete. Received metadata for 95 messages.
2025-10-23 11:32:02,611 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,612 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,612 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,612 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,612 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,612 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,612 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,612 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,612 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,613 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,613 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,613 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,613 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,613 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,613 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,613 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,613 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,613 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,613 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,614 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,614 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,614 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,614 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,614 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,614 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,614 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,614 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,614 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,615 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,615 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,615 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,615 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,615 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,615 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,615 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,615 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,616 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,616 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,616 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,616 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,616 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,616 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,616 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,616 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,616 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,617 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,617 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,617 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,617 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,617 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,617 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,617 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,617 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,617 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,617 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,618 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,618 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,618 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,618 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,618 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,618 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,618 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,618 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,619 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,619 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,619 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,619 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,619 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,619 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,619 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,619 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,619 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,619 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,619 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,620 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,620 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,620 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,620 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,620 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,620 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,620 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,620 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,620 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,620 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,620 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,621 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,621 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,621 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,621 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,621 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,621 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,621 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,621 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,621 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,621 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:32:02,621 - INFO - Created metadata_lookup with 95 emails (excluding ETL-Processed)
2025-10-23 11:33:14,925 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-10-23 11:33:15,448 - INFO - Found 52 message IDs to check.
2025-10-23 11:33:15,448 - INFO - Processing 52 messages in 2 batches of 40
2025-10-23 11:33:15,448 - INFO - Processing metadata batch 1/2 (40 messages)
2025-10-23 11:33:15,837 - ERROR - Failed to get metadata for 199a1af30946f6a5: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/199a1af30946f6a5?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-23 11:33:15,838 - WARNING - Rate limit hit for message 199a1af30946f6a5. Consider reducing batch size.
2025-10-23 11:33:15,838 - ERROR - Failed to get metadata for 1992f0f2e7490fb9: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/1992f0f2e7490fb9?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-23 11:33:15,838 - WARNING - Rate limit hit for message 1992f0f2e7490fb9. Consider reducing batch size.
2025-10-23 11:33:15,838 - ERROR - Failed to get metadata for 1979d4c7083cff97: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/1979d4c7083cff97?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-23 11:33:15,838 - WARNING - Rate limit hit for message 1979d4c7083cff97. Consider reducing batch size.
2025-10-23 11:33:15,838 - ERROR - Failed to get metadata for 1973b2f4fb885968: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/1973b2f4fb885968?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-23 11:33:15,838 - WARNING - Rate limit hit for message 1973b2f4fb885968. Consider reducing batch size.
2025-10-23 11:33:15,838 - ERROR - Failed to get metadata for 19692d0e5fe543d5: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19692d0e5fe543d5?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-23 11:33:15,838 - WARNING - Rate limit hit for message 19692d0e5fe543d5. Consider reducing batch size.
2025-10-23 11:33:15,839 - ERROR - Failed to get metadata for 19663160954a5d41: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19663160954a5d41?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-23 11:33:15,839 - WARNING - Rate limit hit for message 19663160954a5d41. Consider reducing batch size.
2025-10-23 11:33:15,839 - ERROR - Failed to get metadata for 19662bf7442fb9a8: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19662bf7442fb9a8?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-23 11:33:15,839 - WARNING - Rate limit hit for message 19662bf7442fb9a8. Consider reducing batch size.
2025-10-23 11:33:15,839 - ERROR - Failed to get metadata for 196442ea6f8030ff: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/196442ea6f8030ff?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-23 11:33:15,839 - WARNING - Rate limit hit for message 196442ea6f8030ff. Consider reducing batch size.
2025-10-23 11:33:15,839 - ERROR - Failed to get metadata for 195f1da8839ee815: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/195f1da8839ee815?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-23 11:33:15,839 - WARNING - Rate limit hit for message 195f1da8839ee815. Consider reducing batch size.
2025-10-23 11:33:16,345 - INFO - Processing metadata batch 2/2 (12 messages)
2025-10-23 11:33:16,622 - INFO - Metadata batch processing complete. Received metadata for 43 messages.
2025-10-23 11:33:16,622 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,622 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,623 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,623 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,623 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,623 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,623 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,623 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,623 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,624 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,624 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,624 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,624 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,624 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,624 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,624 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,624 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,625 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,625 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,625 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,625 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,625 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,625 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,625 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,625 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,625 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,626 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,626 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,626 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,626 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,626 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,626 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,626 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,626 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,626 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,627 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,627 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,627 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,627 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,627 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,627 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,627 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,627 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:33:16,627 - INFO - Created metadata_lookup with 43 emails (excluding ETL-Processed)
2025-10-23 11:33:36,597 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-10-23 11:33:36,878 - INFO - Found 100 message IDs to check.
2025-10-23 11:33:36,878 - INFO - Processing 100 messages in 3 batches of 40
2025-10-23 11:33:36,878 - INFO - Processing metadata batch 1/3 (40 messages)
2025-10-23 11:33:37,199 - ERROR - Failed to get metadata for 19a1003ed400e664: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a1003ed400e664?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-23 11:33:37,199 - WARNING - Rate limit hit for message 19a1003ed400e664. Consider reducing batch size.
2025-10-23 11:33:37,199 - ERROR - Failed to get metadata for 19a1003e8cba898e: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a1003e8cba898e?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-23 11:33:37,199 - WARNING - Rate limit hit for message 19a1003e8cba898e. Consider reducing batch size.
2025-10-23 11:33:37,200 - ERROR - Failed to get metadata for 19a1003e0245cb27: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a1003e0245cb27?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-23 11:33:37,200 - WARNING - Rate limit hit for message 19a1003e0245cb27. Consider reducing batch size.
2025-10-23 11:33:37,200 - ERROR - Failed to get metadata for 19a1003d614f0585: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a1003d614f0585?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-23 11:33:37,200 - WARNING - Rate limit hit for message 19a1003d614f0585. Consider reducing batch size.
2025-10-23 11:33:37,200 - ERROR - Failed to get metadata for 19a1003bc237107f: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a1003bc237107f?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-23 11:33:37,200 - WARNING - Rate limit hit for message 19a1003bc237107f. Consider reducing batch size.
2025-10-23 11:33:37,200 - ERROR - Failed to get metadata for 19a1003a624a7846: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a1003a624a7846?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-23 11:33:37,200 - WARNING - Rate limit hit for message 19a1003a624a7846. Consider reducing batch size.
2025-10-23 11:33:37,200 - ERROR - Failed to get metadata for 19a1003a311a99ce: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a1003a311a99ce?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-23 11:33:37,200 - WARNING - Rate limit hit for message 19a1003a311a99ce. Consider reducing batch size.
2025-10-23 11:33:37,200 - ERROR - Failed to get metadata for 19a10039c1632171: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a10039c1632171?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-23 11:33:37,200 - WARNING - Rate limit hit for message 19a10039c1632171. Consider reducing batch size.
2025-10-23 11:33:37,200 - ERROR - Failed to get metadata for 19a10038e7c03610: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a10038e7c03610?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-23 11:33:37,200 - WARNING - Rate limit hit for message 19a10038e7c03610. Consider reducing batch size.
2025-10-23 11:33:37,200 - ERROR - Failed to get metadata for 19a100378e68f0aa: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a100378e68f0aa?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-23 11:33:37,200 - WARNING - Rate limit hit for message 19a100378e68f0aa. Consider reducing batch size.
2025-10-23 11:33:37,200 - ERROR - Failed to get metadata for 19a100373cdeb6db: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a100373cdeb6db?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-23 11:33:37,200 - WARNING - Rate limit hit for message 19a100373cdeb6db. Consider reducing batch size.
2025-10-23 11:33:37,200 - ERROR - Failed to get metadata for 19a10037018d24a0: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a10037018d24a0?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-23 11:33:37,200 - WARNING - Rate limit hit for message 19a10037018d24a0. Consider reducing batch size.
2025-10-23 11:33:37,200 - ERROR - Failed to get metadata for 19a10035bad8febd: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a10035bad8febd?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-23 11:33:37,200 - WARNING - Rate limit hit for message 19a10035bad8febd. Consider reducing batch size.
2025-10-23 11:33:37,200 - ERROR - Failed to get metadata for 19a10034e210317a: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a10034e210317a?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-23 11:33:37,201 - WARNING - Rate limit hit for message 19a10034e210317a. Consider reducing batch size.
2025-10-23 11:33:37,201 - ERROR - Failed to get metadata for 19a10034ab39eb21: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a10034ab39eb21?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-23 11:33:37,201 - WARNING - Rate limit hit for message 19a10034ab39eb21. Consider reducing batch size.
2025-10-23 11:33:37,201 - ERROR - Failed to get metadata for 19a10033924af3c1: <HttpError 429 when requesting https://gmail.googleapis.com/gmail/v1/users/me/messages/19a10033924af3c1?format=metadata&alt=json returned "Too many concurrent requests for user.". Details: "[{'message': 'Too many concurrent requests for user.', 'domain': 'global', 'reason': 'rateLimitExceeded'}]">
2025-10-23 11:33:37,201 - WARNING - Rate limit hit for message 19a10033924af3c1. Consider reducing batch size.
2025-10-23 11:33:37,706 - INFO - Processing metadata batch 2/3 (40 messages)
2025-10-23 11:33:38,529 - INFO - Processing metadata batch 3/3 (20 messages)
2025-10-23 11:33:38,714 - INFO - Metadata batch processing complete. Received metadata for 84 messages.
2025-10-23 11:33:38,715 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,715 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,715 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,715 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,715 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,716 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,716 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,716 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,716 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,716 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,716 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,716 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,716 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,717 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,717 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,717 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,717 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,717 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,717 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,717 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,717 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,717 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,718 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,718 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,718 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,718 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,718 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,718 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,718 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,718 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,718 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,719 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,719 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,719 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,719 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,719 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,719 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,719 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,719 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,719 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,719 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,719 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,720 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,720 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,720 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,720 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,720 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,720 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,721 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,721 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,721 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,721 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,721 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,721 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,721 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,721 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,721 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,722 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,722 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,722 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,722 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,722 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,722 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,722 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,722 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,722 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,722 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,722 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,723 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,723 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,723 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,723 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,723 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,723 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,723 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,723 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,723 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,723 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,723 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,723 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,724 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,724 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,724 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,724 - INFO - Extracted vendor 'd&h' from email invoices+d&h@perpay.com
2025-10-23 11:33:38,724 - INFO - Created metadata_lookup with 84 emails (excluding ETL-Processed)
2025-10-23 11:34:15,129 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-10-23 11:34:15,524 - INFO - Found 100 message IDs to check.
2025-10-23 11:34:48,102 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-10-23 11:34:48,531 - INFO - Found 3 message IDs to check.
2025-10-23 11:35:43,887 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-10-23 11:35:44,258 - INFO - Found 3 message IDs to check.
2025-10-23 11:35:44,258 - INFO - Processing 3 messages in 1 batches of 40
2025-10-23 11:35:44,258 - INFO - Processing metadata batch 1/1 (3 messages)
2025-10-23 11:35:44,403 - INFO - Metadata batch processing complete. Received metadata for 3 messages.
2025-10-23 11:35:44,403 - INFO - Extracted vendor 'ssactivewear' from email invoices+ssactivewear@perpay.com
2025-10-23 11:35:44,404 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:35:44,404 - INFO - Extracted vendor 'ssactivewear' from email invoices+ssactivewear@perpay.com
2025-10-23 11:35:44,404 - INFO - Created metadata_lookup with 3 emails (excluding ETL-Processed)
2025-10-23 11:36:25,926 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-10-23 11:36:26,215 - INFO - Found 3 message IDs to check.
2025-10-23 11:36:26,215 - INFO - Processing 3 messages in 1 batches of 40
2025-10-23 11:36:26,215 - INFO - Processing metadata batch 1/1 (3 messages)
2025-10-23 11:36:26,362 - INFO - Metadata batch processing complete. Received metadata for 3 messages.
2025-10-23 11:36:26,363 - INFO - Extracted vendor 'ssactivewear' from email invoices+ssactivewear@perpay.com
2025-10-23 11:36:26,363 - INFO - Extracted vendor 'apex' from email invoices+apex@perpay.com
2025-10-23 11:36:26,363 - INFO - Extracted vendor 'ssactivewear' from email invoices+ssactivewear@perpay.com
2025-10-23 11:36:26,363 - INFO - Created metadata_lookup with 3 emails (excluding ETL-Processed)
